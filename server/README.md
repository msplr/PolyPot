# PolyPot Server

## Intro

The PolyPot Server is a Python app written using Flask and SQLAlchemy.

## Run it!

You can run it on your local machine using the following commands:

```
virtualenv ~/.virtualenv/polypot
source ~/.virtualenv/polypot/bin/activate
cd app
pip install -r requirements.txt
PYTHONDONTWRITEBYTECODE=True POLYPOT_SETTINGS=config-dev.py FLASK_APP=app/polypot_server.py flask run
```

## Docker

Or using Docker:

```
docker build -t polypot:latest .
docker run --rm -it -p 127.0.0.1:5000:5000 -v $(pwd):/polypot/db:Z polypot
```

## Generate fake data set

```
PYTHONDONTWRITEBYTECODE=True POLYPOT_SETTINGS=config-dev.py FLASK_APP=app/populate_db.py flask populate
```

## Testing

You can test the server using the following commands:

```
curl -v localhost:5000/setup -d "@<payload.json>" -H "Content-Type: application/json"
curl -v localhost:5000/send-c-and-c/<uuid> -d "@<payload.json>" -H "Content-Type: application/json"
curl -v localhost:5000/send-data/<uuid> -d "@<payload.json>" -H "Content-Type: application/json"
curl -v localhost:5000/get-latest/<uuid>
curl -v localhost:5000/get-data/<uuid>
```

With `<payload.json>` a file containing the JSON payload of the POST request and `<uuid>` a UUID generated by the server.
